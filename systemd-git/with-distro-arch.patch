--- a/configure.ac	2010-05-05 07:13:33.383357341 -0400
+++ b/configure.ac	2010-05-05 07:15:07.129058039 -0400
@@ -84,6 +84,7 @@
                 AC_CHECK_FILE(/etc/redhat-release,with_distro="fedora")
                 AC_CHECK_FILE(/etc/SuSE-release,with_distro="suse")
                 AC_CHECK_FILE(/etc/debian_version,with_distro="debian")
+                AC_CHECK_FILE(/etc/arch_release,with_distro="arch")
         fi
         if test "z$with_distro" = "z"; then
                 with_distro=`uname -s`
@@ -113,6 +114,13 @@
                 special_syslog_service=sysklogd.service
                 AC_DEFINE(TARGET_DEBIAN, [], [Target is Debian/Ubuntu])
                 ;;
+        arch)
+                SYSTEM_SYSVINIT_PATH=/etc/rc.d
+                SYSTEM_SYSVRCND_PATH=/etc
+                special_dbus_service=dbus.service
+                special_syslog_service=sysklog-ng.service
+                AC_DEFINE(TARGET_ARCH, [], [Target is ArchLinux])
+                ;;
         none)
                 SYSTEM_SYSVINIT_PATH=/fix/the/configure/script
                 SYSTEM_SYSVRCND_PATH=/fix/the/configure/script
--- a/hostname-setup.c	2010-05-05 07:17:52.442757340 -0400
+++ b/hostname-setup.c	2010-05-05 07:24:13.872957408 -0400
@@ -75,6 +75,47 @@
         fclose(f);
         return r;
 
+#if defined(TARGET_ARCH)
+        int r;
+        FILE *f;
+
+        assert(hn);
+
+        if (!(f = fopen("/etc/rc.conf", "re")))
+                return -errno;
+
+        for (;;) {
+                char line[LINE_MAX];
+                char *s, *k;
+
+                if (!fgets(line, sizeof(line), f)) {
+                        if (feof(f))
+                                break;
+
+                        r = -errno;
+                        goto finish;
+                }
+
+                s = strstrip(line);
+
+                if (!startswith(s, "HOSTNAME="))
+                        continue;
+
+                if (!(k = strdup(s+9))) {
+                        r = -ENOMEM;
+                        goto finish;
+                }
+
+                *hn = k;
+                break;
+        }
+
+        r = 0;
+
+finish:
+        fclose(f);
+        return r;
+
 #elif defined(TARGET_SUSE)
         int r;
         char *s, *k;
